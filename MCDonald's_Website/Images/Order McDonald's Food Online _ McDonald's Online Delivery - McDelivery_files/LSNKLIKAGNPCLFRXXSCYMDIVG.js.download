var targetOne={};targetOne.csBaseUrl="https://callback-hrpl.algonomy.com";targetOne.rtBaseUrl="https://callback-hrpl.algonomy.com";targetOne.assetsBaseUrl="https://targetone-pod-hrpl-cf-private.algonomy.com";targetOne.hash="BESQILOBZCGHVLZTCNTGJMYGQEARWVZVCUPYVUGNCZPJRSUDAR";targetOne.siteHash="LSNKLIKAGNPCLFRXXSCYMDIVG";targetOne.siteBaseUrl="http://localhost/magento/";targetOne.eventMappings={};targetOne.popupContent='\x3cdiv id\x3d"t1-popup-outer"\x3e\x3cdiv style\x3d"display:none;"\x3e\x3cdiv id\x3d"t1-popup-full-bottom" class\x3d"t1-popup-full-bottom"\x3e\x3cspan class\x3d"t1-popup-close"\x3e\x26times;\x3c/span\x3e\x3cdiv id\x3d"t1-popup-full-bottom-content" class\x3d"t1-popup-content"\x3e Bottom\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv style\x3d"display:none;"\x3e\x3cdiv id\x3d"t1-popup-full-top" class\x3d"t1-popup-full-top"\x3e\x3cspan class\x3d"t1-popup-close"\x3e\x26times;\x3c/span\x3e\x3cdiv id\x3d"t1-popup-full-top-content" class\x3d"t1-popup-content"\x3eTop\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv style\x3d"display:none;background-color: rgba(0,0,0,0.3);position: absolute;z-index: 9999;left:0;top:0;width: 100%;height: 100%;"\x3e\x3cdiv id\x3d"t1-popup-center" class\x3d"t1-popup-center"\x3e\x3cspan class\x3d"t1-popup-close"\x3e\x26times;\x3c/span\x3e\x3cdiv id\x3d"t1-popup-center-content" class\x3d"t1-popup-content"\x3eCenter\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv style\x3d"display:none;"\x3e\x3cdiv id\x3d"t1-popup-chat" class\x3d"t1-popup-chat"\x3e\x3cspan class\x3d"t1-popup-close"\x3e\x26times;\x3c/span\x3e\x3cdiv id\x3d"t1-popup-chat-content" class\x3d"t1-popup-content"\x3eChat\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cstyle\x3e.t1-popup-outer{position: fixed;z-index: 999;left:0;top:0;width: 100%;height: 100%;overflow: auto;-webkit-animation-name: fadeIn;-webkit-animation-duration: 0.4s;animation-name: fadeIn;animation-duration: 0.4s;}.t1-popup-close{ color: #aaaaaa;font-size: 28px; font-weight: bold;margin: -6px 8px 10px 0; display: block;height: 20px; text-align:right;}.t1-popup-close:hover,.t1-popup-close:focus { color: #000; text-decoration: none; cursor: pointer;}.t1-popup-full-top { position: fixed;background-color: #F6F6F6; margin: auto; border: 1px solid #E6E6E6; width: 100%;height:35%;-webkit-animation-name: slideDown; -webkit-animation-duration: 0.4s; animation-name: slideDown; animation-duration: 0.4s;display:none;}.t1-popup-full-bottom { position: fixed; border: 1px solid #E6E6E6; bottom: 0; background-color: #F2F2F2; width: 100%;height:35%; -webkit-animation-name: slideIn; -webkit-animation-duration: 0.4s; animation-name: slideIn; animation-duration: 0.4s;display:none;}.t1-popup-center{border-radius: 15px;position: fixed;background-color: #F2F2F2; margin: auto; border: 2px solid #E6E6E6; width: 60%;height:60%;left:20%;top:20%;display:none;}.t1-popup-chat{position: fixed;background-color: #fefefe; margin: auto; border: 2px solid #C0C0C0; width: 300px;height: 400px;bottom: 10px; right: 18px;display:none;-webkit-animation-name: slideIn; -webkit-animation-duration: 0.6s; animation-name: slideIn; animation-duration: 0.6s;}.t1-popup-content{margin:10px;height:85%;overflow:auto}#t1-popup-chat .t1-popup-content{margin:10px;height:92%;overflow:auto}@-webkit-keyframes slideIn { from {bottom: -300px; opacity: 0} to {bottom: 0; opacity: 1}}@keyframes slideIn { from {bottom: -300px; opacity: 0} to {bottom: 0; opacity: 1}}@-webkit-keyframes fadeIn { from {opacity: 0} to {opacity: 1}}@keyframes fadeIn { from {opacity: 0} to {opacity: 1}}@-webkit-keyframes slideDown { from {top: -300px; opacity: 0} to {top: 0; opacity: 1}}@keyframes slideDown { from {top: -300px; opacity: 0} to {top: 0; opacity: 1}}\x3c/style\x3e';
targetOne.loadedBannerLocation=[];targetOne.sessionCookieLifeTime=1800;targetOne.customerObj={};targetOne.srcType="";targetOne.getAjaxHander=function(){var ajaxHttp;try{if(window.ajaxHttpRequest)ajaxHttp=new ajaxHttpRequest;else ajaxHttp=new ActiveXObject("Microsoft.ajaxHttp")}catch(e){ajaxHttp=new XMLHttpRequest}return ajaxHttp};
targetOne.setObjContent=function(bannerHtmlContent,prefix,dataObj){if(typeof dataObj=="string"||typeof dataObj=="number")return bannerHtmlContent;for(var key in dataObj){var value=dataObj[key];if(value==null)continue;var actualKey=null;var firstLr=key.charAt(0).toUpperCase();key=firstLr+key.substr(1);if(prefix=="")actualKey=key;else actualKey=prefix+"."+key;var actualKey1="{"+actualKey+"}";bannerHtmlContent=bannerHtmlContent.replace(RegExp(actualKey1,"gi"),value);if(Array.isArray(value))bannerHtmlContent=
this.setArrayContent(bannerHtmlContent,actualKey,value);else bannerHtmlContent=this.setObjContent(bannerHtmlContent,actualKey,value)}return bannerHtmlContent};targetOne.setArrayContent=function(bannerHtmlContent,prefix,dataArray){var i=0;for(i=0;i<dataArray.length;i++)bannerHtmlContent=this.setObjContent(bannerHtmlContent,prefix+"."+(i+1),dataArray[i]);return bannerHtmlContent};
targetOne.displayBannerIfNeeded=function(banner,event,data){if(data&&data.ruleMatched&&!targetOne.loadedBannerLocation.includes(banner.bannerLocation)){targetOne.loadedBannerLocation.push(banner.bannerLocation);var finalHtmlValue=this.setObjContent(banner.htmlContent,"",data);var bannerLoc=document.getElementById(banner.bannerLocation);finalHtmlValue=finalHtmlValue.replace(/@@@displayTitle@@@/gi,data.displayTitle);finalHtmlValue=finalHtmlValue.replace(/@@@bannerHash@@@/g,banner.bannerHash);if(bannerLoc!=
null){bannerLoc.innerHTML=finalHtmlValue;targetOne.findLinksInBanner(banner,bannerLoc,banner.bannerHash,1)}if(this.bannerJsCallBack!=undefined&&this.CallBack!=null)try{this.bannerJsCallBack(banner,event,data)}catch(err){console.log(err)}}};
targetOne.sendBannerClickEvent=function(banner,trackingId,clickUrl,type){var eventName="eventAppNotification";if(type==1)eventName="eventBannerClick";var eventDataObj={};eventDataObj["t1TrackingId"]=trackingId;eventDataObj["type"]="click";eventDataObj["bannerHash"]=banner.bannerHash;eventDataObj["clickUrl"]=clickUrl;var payloadObj=this.getEventPayload(eventDataObj,eventName);var url=this.csBaseUrl+"/rest/events/"+this.hash+"/"+eventName;var ajaxHttp=this.getAjaxHander();ajaxHttp.open("POST",url,true);
ajaxHttp.setRequestHeader("Content-type","application/json");var thisObj=this;ajaxHttp.onreadystatechange=function(){if(ajaxHttp.readyState==ajaxHttp.DONE)location.href=clickUrl};ajaxHttp.send(JSON.stringify(payloadObj.payload))};
targetOne.executeRtBannerRequest=function(banner,event,clickStream){if(targetOne.loadedBannerLocation.includes(banner.bannerLocation))return false;var url=targetOne.rtBaseUrl+"/bannerPortlet/events/"+this.hash+"/"+event.eventType+"/"+banner.bannerHash+"?cs\x3d"+clickStream;var ajaxHttp=this.getAjaxHander();ajaxHttp.open("POST",url,true);if(event.encrypted)ajaxHttp.setRequestHeader("Content-type","application/encrypted");else ajaxHttp.setRequestHeader("Content-type","application/json");var thisObj=
this;ajaxHttp.onreadystatechange=function(){if(ajaxHttp.readyState==ajaxHttp.DONE)if(ajaxHttp.status==200){var jsonResponse=JSON.parse(ajaxHttp.responseText);if(jsonResponse){var htmlContent=jsonResponse.content;var trackingId=jsonResponse.trackingId;if(banner.bannerContentType=="html"){if(!targetOne.loadedBannerLocation.includes(banner.bannerLocation)){targetOne.loadedBannerLocation.push(banner.bannerLocation);var bannerLoc=document.getElementById(banner.bannerLocation);targetOne.loadedBannerLocation.push(banner.bannerLocation);
bannerLoc.innerHTML=htmlContent;targetOne.findLinksInBanner(banner,bannerLoc,trackingId,2)}}else if(banner.bannerContentType=="popup"){if(!targetOne.loadedBannerLocation.includes(banner.bannerLocation)&&htmlContent!=undefined){targetOne.loadedBannerLocation.push(banner.bannerLocation);var bannerLocContent=document.getElementById(banner.bannerLocation+"-content");var bannerLocContainer=document.getElementById(banner.bannerLocation);var bannerParent=bannerLocContainer.parentNode;bannerLocContent.innerHTML=
htmlContent;bannerLocContainer.style.display="block";bannerParent.style.display="block";bannerParent.className="t1-popup-outer";targetOne.findLinksInBanner(banner,bannerLocContainer,trackingId,2)}}else thisObj.displayBannerIfNeeded(banner,event,jsonResponse)}}};if(event.encrypted)ajaxHttp.send(event.payload);else ajaxHttp.send(JSON.stringify(event.payload))};
targetOne.loadBanner=function(banner,event,clickStream){var bannerLoc=document.getElementById(banner.bannerLocation);if(bannerLoc==null||bannerLoc==undefined)return false;if(banner.bannerContentType=="html"||banner.bannerContentType=="popup"){this.executeRtBannerRequest(banner,event,clickStream);return}var url=this.assetsBaseUrl+"/"+this.hash+"/"+banner.templateHash+".html";var dateString=null;if(localStorage)dateString=localStorage.getItem(banner.templateHash+".date");var date=null;var ajaxHttp=
this.getAjaxHander();ajaxHttp.open("GET",url,true);if(dateString!=null);var thisObj=this;ajaxHttp.onreadystatechange=function(){if(ajaxHttp.readyState==ajaxHttp.DONE)if(ajaxHttp.status==200){banner["htmlContent"]=ajaxHttp.responseText;dateValue=ajaxHttp.getResponseHeader("Last-Modified");if(localStorage){localStorage.setItem(banner.templateHash+".date",dateValue);localStorage.setItem(banner.templateHash+".content",banner.htmlContent)}thisObj.executeRtBannerRequest(banner,event,clickStream)}else if(ajaxHttp.status==
304){if(localStorage)banner["htmlContent"]=localStorage.getItem(banner.templateHash+".content");thisObj.executeRtBannerRequest(banner,event,clickStream);console.log("Cache")}else;};ajaxHttp.send();return true};
targetOne.clickStreamPost=function(event){var path=this.csBaseUrl+"/rest/events/"+this.hash+"/"+event.eventType+"?async\x3dtrue";var ajaxHttp=this.getAjaxHander();ajaxHttp.open("POST",path,true);if(event.encrypted){ajaxHttp.setRequestHeader("Content-type","application/encrypted");ajaxHttp.send(event.payload)}else{ajaxHttp.setRequestHeader("Content-type","application/json");ajaxHttp.send(JSON.stringify(event.payload))}ajaxHttp.onreadystatechange=function(){if(ajaxHttp.readyState==ajaxHttp.DONE)if(ajaxHttp.status==
202){let lastItem=ajaxHttp.responseURL.substring(ajaxHttp.responseURL.lastIndexOf("/")+1);lastItem=lastItem.split("?")[0];if("eventWebRegistration"==lastItem)localStorage.setItem("__T1_WebTokenRegistered",targetOne.deviceToken)}}};
targetOne.findLinksInBanner=function(banner,bannerDiv,trackingId,type){if(bannerDiv!=null){tId=trackingId;var arrLink=bannerDiv.getElementsByTagName("a");for(var i=0;i<arrLink.length;i++){var elem=arrLink[i];elem.setAttribute("data-tracking-id",trackingId);elem.setAttribute("data-type-id",type);elem.onclick=function(e){targetOne.sendBannerClickEvent(banner,this.getAttribute("data-tracking-id"),this.href,this.getAttribute("data-type-id"));e.preventDefault()}}}};
targetOne.bannerClickEvent=function(eventObj){console.log(eventObj);eventObj.preventDefault()};window.onclick=function(event){if(event.target==document.getElementById("t1-popup-outer")){document.getElementById("t1-popup-outer").style.display="none";document.getElementById("t1-popup-outer").className=""}};targetOne.popupClose=function(){this.parentNode.style.display="none";this.parentNode.parentNode.style.display="none";document.getElementById("t1-popup-outer").className=""};
targetOne.init=function(){var popupDiv=document.createElement("div");popupDiv.innerHTML=targetOne.popupContent;document.body.appendChild(popupDiv);var closePopupClass=document.getElementsByClassName("t1-popup-close");for(var i=0;i<closePopupClass.length;i++)closePopupClass[i].addEventListener("click",targetOne.popupClose,false)};
targetOne.executeEvent=function(eventObj,rrObj,rrCallback){targetOne.init();eventObj=eval("("+eventObj+")");var eventBanners=this.eventMappings[eventObj.eventType];if(eventBanners!=null){var i=0;for(i=0;i<eventBanners.length;i++)this.loadBanner(eventBanners[i],eventObj,false)}this.clickStreamFetch(eventObj)};
targetOne.ajaxCallBack=function(response){var headers=response.getAllResponseHeaders();if(headers.includes("Targetoneevent")){var targetOneHeader=response.getResponseHeader("Targetoneevent");if(targetOneHeader!=null&&targetOneHeader!=undefined){console.log(targetOneHeader);this.executeEvent(targetOneHeader)}}};const {fetch:originalFetch}=window;
window.fetch=async(...args)=>{let [resource,config]=args;const response=await originalFetch(resource,config);try{if(resource!=null&&!resource.startsWith(targetOne.csBaseUrl)){let clone=await response.clone();let reader=clone.body.getReader();let decoder=new TextDecoder("utf-8");reader.read().then(function(res){let decodedRes=decoder.decode(res.value);let result={};try{if(decodedRes!=null&&decodedRes.length>0)result=JSON.parse(decodedRes)}catch(err){console.log("decode error"+err)}let value="";if(config!=
undefined&&config.body!=undefined)try{if(typeof config.body=="string")value=JSON.parse(config.body);else if(typeof config.body=="object"&&config.body instanceof FormData)config.body.forEach((dataVal,key)=>value[key]=dataVal)}catch(e){}let req={};req.responseURL=resource;targetOne.ajaxInterceptorFuntionsCall(req,value,result)})}}catch(e){let eventData={};eventData["error"]=e.message;eventData["page"]="Error Intercept the fetch request";eventData["method"]="FetchMethod";this.executeEventByData(eventData,
"eventException")}return response};document.addEventListener("submit",function(w){try{targetOne.onloadFuntionsCall()}catch(e){console.log(e);eventData["error"]=e.message;eventData["page"]="Error Intercept the fetch request";eventData["method"]="FetchMethod";this.executeEventByData(eventData,"eventException")}});XMLHttpRequest.prototype.realSend=XMLHttpRequest.prototype.send;
XMLHttpRequest.prototype.send=function(value){this.addEventListener("load",function(){try{targetOne.ajaxCallBack(this);targetOne.ajaxInterceptorFuntionsCall(this,value,"")}catch(e){console.log("XMLHttpRequest addEventListener error:"+e)}},false);this.realSend(value)};targetOne.randomString=function(length){var text="";var possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var i=0;i<length;i++)text+=possible.charAt(Math.floor(Math.random()*possible.length));return text.toUpperCase()};
targetOne.setCookie=function(cname,cvalue,life){if(life===undefined)life=1E3;var d=new Date;d.setTime(d.getTime()+this.sessionCookieLifeTime*life);var expires="expires\x3d"+d.toUTCString();document.cookie=cname+"\x3d"+cvalue+";"+expires+";path\x3d/"};
targetOne.getCookie=function(cname){var name=cname+"\x3d";var decodedCookie=decodeURIComponent(document.cookie);var ca=decodedCookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" ")c=c.substring(1);if(c.indexOf(name)==0)return c.substring(name.length,c.length)}return""};
targetOne.generateUUID=function(){var TARGETONE_UUID_COOKIE="_TargetOne_clientCorrelatorId";if(this.getCookie(TARGETONE_UUID_COOKIE))return this.getCookie(TARGETONE_UUID_COOKIE);else{var rndStr=this.randomString(50);this.setCookie(TARGETONE_UUID_COOKIE,rndStr,10*365*24*60*60*10);return rndStr}};
targetOne.getUserAgentObj=function(){var unknown="-";var timeZone=(new Date).toString().match(/([A-Z]+[\+-][0-9]+.*)/)[1];var deviceType="";var screenSize="";if(screen.width){width=screen.width?screen.width:"";height=screen.height?screen.height:"";screenSize+=""+width+" x "+height}var nVer=navigator.appVersion;var nAgt=navigator.userAgent;var browser=navigator.appName;var version=""+parseFloat(navigator.appVersion);var majorVersion=parseInt(navigator.appVersion,10);var nameOffset,verOffset,ix;if((verOffset=
nAgt.indexOf("Opera"))!=-1){browser="Opera";version=nAgt.substring(verOffset+6);if((verOffset=nAgt.indexOf("Version"))!=-1)version=nAgt.substring(verOffset+8)}if((verOffset=nAgt.indexOf("OPR"))!=-1){browser="Opera";version=nAgt.substring(verOffset+4)}else if((verOffset=nAgt.indexOf("Edge"))!=-1){browser="Microsoft Edge";version=nAgt.substring(verOffset+5)}else if((verOffset=nAgt.indexOf("MSIE"))!=-1){browser="Microsoft Internet Explorer";version=nAgt.substring(verOffset+5)}else if((verOffset=nAgt.indexOf("Chrome"))!=
-1){browser="Chrome";version=nAgt.substring(verOffset+7)}else if((verOffset=nAgt.indexOf("Safari"))!=-1){browser="Safari";version=nAgt.substring(verOffset+7);if((verOffset=nAgt.indexOf("Version"))!=-1)version=nAgt.substring(verOffset+8)}else if((verOffset=nAgt.indexOf("Firefox"))!=-1){browser="Firefox";version=nAgt.substring(verOffset+8)}else if(nAgt.indexOf("Trident/")!=-1){browser="Microsoft Internet Explorer";version=nAgt.substring(nAgt.indexOf("rv:")+3)}else if((nameOffset=nAgt.lastIndexOf(" ")+
1)<(verOffset=nAgt.lastIndexOf("/"))){browser=nAgt.substring(nameOffset,verOffset);version=nAgt.substring(verOffset+1);browser=browser.replace("[");if(nAgt.indexOf("FBAN")>-1||nAgt.indexOf("FBAV")>-1){browser="Facebook Web";version="-"}if(browser.length>30){browser="Other";version="-"}if(browser.toLowerCase()==browser.toUpperCase())browser=navigator.appName}if((ix=version.indexOf(";"))!=-1)version=version.substring(0,ix);if((ix=version.indexOf(" "))!=-1)version=version.substring(0,ix);if((ix=version.indexOf(")"))!=
-1)version=version.substring(0,ix);majorVersion=parseInt(""+version,10);if(isNaN(majorVersion)){version=""+parseFloat(navigator.appVersion);majorVersion=parseInt(navigator.appVersion,10)}var isMobile=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(nVer);if(isMobile)deviceType="Mobile";else deviceType="PC";var cookieEnabled=navigator.cookieEnabled?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!cookieEnabled){document.cookie="testcookie";cookieEnabled=document.cookie.indexOf("testcookie")!=
-1?true:false}var os=unknown;var clientStrings=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},
{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];
for(var id in clientStrings){var cs=clientStrings[id];if(cs.r.test(nAgt)){os=cs.s;break}}var osVersion=unknown;if(/Windows/.test(os)){osVersion=/Windows (.*)/.exec(os)[1];os="Windows"}switch(os){case "Mac OS X":osVersion=/Mac OS X (10[\._\d]+)/.exec(nAgt)[1];break;case "Android":osVersion=/Android ([\._\d]+)/.exec(nAgt)[1];break;case "iOS":osVersion=/OS (\d+)_(\d+)_?(\d+)?/.exec(nVer);osVersion=osVersion[1]+"."+osVersion[2]+"."+(osVersion[3]|0);break}var flashVersion="no check";if(typeof swfobject!=
"undefined"){var fv=swfobject.getFlashPlayerVersion();if(fv.major>0)flashVersion=fv.major+"."+fv.minor+" r"+fv.release;else flashVersion=unknown}return userAgentObj={screenResolution:screenSize,browserType:browser,timezone:timeZone,browserVersion:version,customerDeviceType:deviceType,isMobileDevice:deviceType=="Mobile"?true:false,customerDeviceOs:os,customerDeviceOsVersion:osVersion,cookieSupport:cookieEnabled,language:navigator.languages[0]||navigator.language}};
targetOne.getPageObj=function(){var title=document.getElementsByTagName("title")[0].innerHTML;if(title.length>100)title=title.substring(0,100);var pageKey=title.replace(/[^A-Z0-9]/ig,"_");return{pageName:title,pageKey:pageKey,pageUrl:window.location.host+window.location.pathname}};targetOne.getUTMObj=function(){return{source:this.getParameterByName("utm_source"),medium:this.getParameterByName("utm_medium"),campaign:this.getParameterByName("utm_campaign"),urlId:this.getParameterByName("t1_urlid")}};
targetOne.getSessionObj=function(){var sessionObj={};var TARGETONE_SESSION_COOKIE="_TargetOne_ShortLivedCookie";var TARGETONE_SESSION_COOKIE_START_TIME="_TargetOne_Session_Cookie_start_time";var TARGETONE_SESSION_COOKIE_TIME="_TargetOne_Session_Cookie_Time";var currentCookieTime=this.getCookie(TARGETONE_SESSION_COOKIE_TIME);var currentSessionStartDate=this.getCookie(TARGETONE_SESSION_COOKIE_START_TIME);var referrer="";var referrerName="";try{var referrerHost=(new URL(document.referrer)).hostname;
if(!referrerHost.localeCompare(location.hostname)){referrer=referrerHost;referrerName=referrerHost}}catch(e){}var currentDate=new Date;var currentTime=currentDate.getTime();var currentVal=this.getCookie(TARGETONE_SESSION_COOKIE);if(currentCookieTime)if((currentTime-currentCookieTime)/1E3<this.sessionCookieLifeTime){this.setCookie(TARGETONE_SESSION_COOKIE,currentVal);this.setCookie(TARGETONE_SESSION_COOKIE_TIME,currentTime);this.setCookie(TARGETONE_SESSION_COOKIE_START_TIME,currentSessionStartDate)}else{currentVal=
this.randomString(32);currentSessionStartDate=(new Date).toJSON().replace("T"," ").replace("Z"," UTC");this.setCookie(TARGETONE_SESSION_COOKIE,currentVal);this.setCookie(TARGETONE_SESSION_COOKIE_TIME,currentTime);this.setCookie(TARGETONE_SESSION_COOKIE_START_TIME,currentSessionStartDate)}else{currentVal=this.randomString(32);currentSessionStartDate=(new Date).toJSON().replace("T"," ").replace("Z"," UTC");this.setCookie(TARGETONE_SESSION_COOKIE,currentVal);this.setCookie(TARGETONE_SESSION_COOKIE_TIME,
currentTime);this.setCookie(TARGETONE_SESSION_COOKIE_START_TIME,currentSessionStartDate)}sessionObj={sessionKey:currentVal,shortLivedCookie:currentVal,referrerSourceURL:referrer,referrerName:referrerName,lat:this.getCookie("TargetOne_User_Latitude"),lon:this.getCookie("TargetOne_User_Longitude"),sessionStartTime:currentSessionStartDate,locale:navigator.languages[0]||navigator.language};return sessionObj};
targetOne.getUserPosition=function(position){targetOne.setCookie("TargetOne_User_Latitude",position.coords.latitude);targetOne.setCookie("TargetOne_User_Longitude",position.coords.longitude)};if(navigator.geolocation)navigator.geolocation.getCurrentPosition(targetOne.getUserPosition);targetOne.setCustomer=function(customerObj){if(typeof customerObj==="string"||customerObj instanceof String)customerObj=eval("("+customerObj+")");if(customerObj==null)customerObj={};targetOne.customerObj=customerObj};
targetOne.getEventPayload=function(eventDataObj,eventName){var vEventObj={};var currentDateObj=new Date;if(typeof eventDataObj==="string"||eventDataObj instanceof String)eventDataObj=eval("("+eventDataObj+")");var customerObj=targetOne.customerObj;var payloadObj={};payloadObj["srcId"]="WBSTR";payloadObj["srcType"]=this.srcType;payloadObj["siteHash"]=this.siteHash;payloadObj["eventDateTime"]=currentDateObj.toJSON().replace("T"," ").replace("Z"," UTC");payloadObj["requestTime"]=currentDateObj.getTime();
payloadObj["clientCorrelatorId"]=this.generateUUID();vEventObj["eventType"]=eventName;vEventObj["encrypted"]=false;payloadObj["eventData"]=eventDataObj;customerObj["uuid"]=this.generateUUID();payloadObj["customer"]=targetOne.customerObj;payloadObj["session"]=this.getSessionObj();payloadObj["page"]=this.getPageObj();payloadObj["page"]["pageKey"]=eventName;payloadObj["utm"]=this.getUTMObj();payloadObj["userAgent"]=this.getUserAgentObj();vEventObj["payload"]=payloadObj;return vEventObj};
targetOne.executeEventByData=function(eventDataObj,eventName,rrObj,rrCalback){try{var payload=this.getEventPayload(eventDataObj,eventName);this.executeEvent(JSON.stringify(payload),rrObj,rrCalback)}catch(e){console.log(e)}};targetOne.util={};targetOne.qaMode=false;targetOne.simulationMode=false;targetOne.util.log=function(dataToLog){if(simulationMode)parent.sumulateLogAppend(dataToLog);else if(qaMode)console.log(dataToLog)};targetOne.globalSwitchOff=false;targetOne.suportedDomains=[];
targetOne.isQaVersion=function(){var reqParam=targetOne.getParameterByName("targetOneQa");if(reqParam=="1"){localStorage.setItem("targetOneQa","1");return true}else if(reqParam=="0"){localStorage.setItem("targetOneQa","0");return false}else if(localStorage.getItem("targetOneQa")=="1")return true;return false};targetOne.validate=function(){return true};try{targetOne.jiwContainer={"onPageLoadFuntions":[],"ajaxInserFuntions":[]}}catch(e){console.log(e)}
targetOne.checkForSimulate=async function(){var reqParam=this.getParameterByName("simulateJiw");if(reqParam!=null){const _JIW_URL=this.assetsBaseUrl+"/"+this.hash+"/simulate/"+reqParam+".json";const response=await fetch(_JIW_URL);const data=await response.text();targetOne.jiwContainer=JSON.parse(data);targetOne.onloadFuntionsCall();return true}return false};
targetOne.zeroCodeInit=async function(){targetOne.checkEventExist();if(this.checkForSimulate()==false)return;if(targetOne.isQaVersion()){try{const QA_JIW_URL=this.assetsBaseUrl+"/"+this.hash+"/"+this.siteHash+"_qa.json";const response=await fetch(QA_JIW_URL);const data=await response.text();targetOne.jiwContainer=JSON.parse(data);targetOne.qaMode=true;targetOne.onloadFuntionsCall()}catch(err){console.log(err)}return}targetOne.onloadFuntionsCall()};
targetOne.util={executeOnLoad:function(context){const jsonStr=JSON.stringify(context);sessionStorage.setItem("__targetOneEvent",jsonStr)},getParamByName:function(name,content){return targetOne.getParameterByName(name,content)}};
targetOne.checkEventExist=function(){const contextStr=sessionStorage.getItem("__targetOneEvent");if(contextStr!=null){const contextObj=JSON.parse(contextStr);let contextIdentity=contextObj.config.identity;if(contextIdentity!=null){let identityVal=(new Function(contextIdentity))();if(identityVal!=undefined&&identityVal!=null&&identityVal!=""){let eventData=contextObj.eventData;eventData.customerCode=identityVal;let email=eventData.customerEmailId;let mobile=eventData.mobile;let customer={"email":email,
"mobile":mobile,"customerCode":identityVal};this.setCustomer(customer);this.executeEventByData(eventData,contextObj.eventType);sessionStorage.removeItem("__targetOneEvent")}}}};
targetOne.onloadFuntionsCall=function(){if(!targetOne.validate())return;let finalEventContext=null;for(var i=0;i<targetOne.jiwContainer.onPageLoadFuntions.length;i++){let funPointer=targetOne.jiwContainer.onPageLoadFuntions[i];let context={eventData:{},config:{},eventType:null,util:this.util};let args={eventContext:context},fnString=funPointer;try{let fn=Function.apply(Function,Object.keys(args).concat(fnString));let result=fn.apply(fn,Object.keys(args).map(key=>args[key]));if(result){finalEventContext=
context;break}}catch(e){let contentJiw=funPointer;if(contentJiw.length>100)contentJiw=contentJiw.substring(0,100);let eventData={};eventData["error"]=e.message+"\x3d\x3d JIW : "+contentJiw;eventData["page"]="execute on JIWs";eventData["method"]="onloadFuntionsCall";this.executeEventByData(eventData,"eventException")}}if(finalEventContext!=null&&finalEventContext.eventType!=null)targetOne.executeOnContext(finalEventContext)};
targetOne.ajaxInterceptorFuntionsCall=function(request,body,response){if(!targetOne.validate())return;var finalEventContext=null;for(var i=0;i<targetOne.jiwContainer.ajaxInserFuntions.length;i++){let funPointer=targetOne.jiwContainer.ajaxInserFuntions[i];const context={eventData:{},config:{},eventType:null,util:this.util};let ajaxContext={"request":request,"body":body,"response":response};let args={eventContext:context,ajaxContext:ajaxContext},fnString=funPointer;let fn=Function.apply(Function,Object.keys(args).concat(fnString));
try{let result=fn.apply(fn,Object.keys(args).map(key=>args[key]));if(result){finalEventContext=context;break}}catch(e){let contentJiw=funPointer;if(contentJiw.length>125)contentJiw=contentJiw.substring(0,125);if(!this.getCookie("lastExceptionFired")){let eventData={};eventData["error"]=e+"- JIW: "+contentJiw;eventData["page"]="execute on JIWs - ";eventData["method"]="ajaxInterceptorFuntionsCall";this.executeEventByData(eventData,"eventException");this.setCookie("lastExceptionFired",1,60)}}}if(finalEventContext!=
null&&finalEventContext.eventType!=null)targetOne.executeOnContext(finalEventContext)};targetOne.executeOnContext=function(eventContext){try{this.executeEventByData(eventContext.eventData,eventContext.eventType)}catch(e){let eventData={};eventData["error"]=e.message;eventData["page"]=eventContext.eventType;eventData["method"]="executeOnContext";this.executeEventByData(eventData,"eventException")}};
targetOne.getParameterByName=function(name,url=window.location.href){name=name.replace(/[\[\]]/g,"\\$\x26");var regex=new RegExp("[?\x26]"+name+"(\x3d([^\x26#]*)|\x26|#|$)"),results=regex.exec(url);if(!results)return null;if(!results[2])return"";return decodeURIComponent(results[2].replace(/\+/g," "))};
targetOne.clickStreamFetch=function(event){try{let path=this.csBaseUrl+"/rest/events/"+this.hash+"/"+event.eventType;fetch(path,{method:"POST",keepalive:true,headers:{"Content-Type":"application/json"},body:JSON.stringify(event.payload)})}catch(e){let eventData={};eventData["error"]=e.message;eventData["page"]="event.eventType";eventData["method"]="targetOne.clickStreamFetch";this.executeEventByData(eventData,"eventException")}};
targetOne.executeOnExit=function(eventDataObj,eventName){try{const payload=this.getEventPayload(eventDataObj,eventName);this.clickStreamFetch(payload)}catch(e){let eventData={};eventData["error"]=e.message;eventData["page"]="eventName";eventData["method"]="targetOne.executeOnExit";this.executeEventByData(eventData,"eventException")}};function __docReadyRcdp(a){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(a,1):document.addEventListener("DOMContentLoaded",a)}__docReadyRcdp(function(){targetOne.zeroCodeInit()});